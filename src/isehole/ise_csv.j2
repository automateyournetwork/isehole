{%- if "/ers/config/allowedprotocols" in api %}Name,ID,Description,Allow CHAP,Allow EAP FAST,Allow EAP MD5,Allow EAP TLS,Allow EAP TTLS,Allow LEAP,Allow MS CHAP V1,Allow MS CHAP V2,Allow PAP ASCII,Allow PEAP,Allow Preferred EAP Protocol,Allow TEAP,Allow Weak Ciphers For EAP,EAP FAST Allow EAP GTC,EAP FAST Allow EAP GTC Password Change,EAP FAST Allow EAP GTC Password Change Retries,EAP FAST Allow EAP MS CHAP V2,EAP FAST Allow EAP MS CHAP V2 Password Change,EAP FAST Allow EAP MS CHAP V2 Password Change Retries,EAP FAST Allow EAP TLS,EAP FAST Allow EAP TLS Auth Of Expired Certs,EAP FAST EAP FAST Enable EAP Chaining,EAP FAST EAP FAST Use Pacs,EAP FAST EAP FAST Use Pacs Accept Client Cert,EAP FAST EAP FAST Use Pacs Allow Anonymous Provisioning,EAP FAST EAP FAST Use Pacs Allow Authentication Provisioning,EAP FAST EAP FAST Use Pacs Allow Machine Authentication,EAP FAST EAP FAST Use Pacs Authorization Pac TTL,EAP FAST EAP FAST Use Pacs Authorization Pac TTL Units,EAP FAST EAP FAST Use Pacs Machine Pac TTL,EAP FAST EAP FAST Use Pacs Machine Pac TTL Units,EAP FAST EAP FAST Use Pacs Server Returns,EAP FAST EAP FAST Use Pacs Stateless Session Resume,EAP FAST EAP FAST Use Pacs Tunnel Pac TTL,EAP FAST EAP FAST Use Pacs Tunnel Pac TTL Units,EAP FAST EAP FAST Use Pacs Use Proactive Pac Update Precentage,EAP TLS Allow EAP TLS Auth Of Expired Certs,EAP TLS Enable Stateless Session Resume,EAP TLS LBit,EAP TTLS CHAP,EAP TTLS EAP MD5,EAP TTLS EAP MS CHAP V2,EAP TTLS EAP MS CHAP V2 Password Change,EAP TTLS EAP MS CHAP V2 Password Change Retries,EAP TTLS MS CHAP V1,EAP TTLS MS CHAP V2,EAP TTLS PAP ASCII,PEAP Allow PEAP EAP GTC,PEAP Allow PEAP EAP GTC Password Change,PEAP Allow PEAP EAP GTC Passwordd Change Retries,PEAP Allow PEAP EAP MS CHAP V2,PEAP Allow PEAP EAP MS CHAP V2 Password Change,PEAP Allow PEAP EAP MS CHAP V2 Password Change Retries,PEAP Allow PEAP EAP TLS,PEAP Allow PEAP EAP TLS Auth Of Expired Certs,PEAP Allow PEAP V0,PEAP Require Cryptobinding,Process Host Lookup,Require Message Auth,TEAP Accept Client Cert During Tunnel Est,TEAP Allow Downgrade Msk,TEAP Allow TEAP EAP MS CHAP V2,TEAP Allow TEAP EAP MS CHAP V2 Password Change,TEAP Allow TEAP EAP MS CHAP V2 Password Change Retries,TEAP Allow TEAP EAP TLS,TEAP Allow TEAP EAP TLS Auth Of Expired Certs,TEAP Enable EAP Chaining
{%-     for result in data_to_template %}
{%-         for hit in result %}
{{ hit.AllowedProtocols.name }},{{ hit.AllowedProtocols.id }},{{ hit.AllowedProtocols.description }},{{ hit.AllowedProtocols.allowChap }},{{ hit.AllowedProtocols.allowEapFast }},{{ hit.AllowedProtocols.allowEapMd5 }},{{ hit.AllowedProtocols.allowEapTls }},{{ hit.AllowedProtocols.allowEapTtls }},{{ hit.AllowedProtocols.allowLeap }},{{ hit.AllowedProtocols.allowMsChapV1 }},{{ hit.AllowedProtocols.allowMsChapV2 }},{{ hit.AllowedProtocols.allowPapAscii }},{{ hit.AllowedProtocols.allowPeap }},{{ hit.AllowedProtocols.allowPreferredEapProtocol }},{{ hit.AllowedProtocols.allowTeap }},{{ hit.AllowedProtocols.allowWeakCiphersForEap }},{%- if hit.AllowedProtocols.eapFast %}{{ hit.AllowedProtocols.eapFast.allowEapFastEapGtc }},{{ hit.AllowedProtocols.eapFast.allowEapFastEapGtcPwdChange }},{{ hit.AllowedProtocols.eapFast.allowEapFastEapGtcPwdChangeRetries }},{{ hit.AllowedProtocols.eapFast.allowEapFastEapMsChapV2 }},{{ hit.AllowedProtocols.eapFast.allowEapFastEapMsChapV2PwdChange }},{{ hit.AllowedProtocols.eapFast.allowEapFastEapMsChapV2PwdChangeRetries }},{{ hit.AllowedProtocols.eapFast.allowEapFastEapTls }},{{ hit.AllowedProtocols.eapFast.allowEapFastEapTlsAuthOfExpiredCerts }},{{ hit.AllowedProtocols.eapFast.eapFastEnableEAPChaining }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacs }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsAcceptClientCert }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsAllowAnonymProvisioning }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsAllowAuthenProvisioning }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsAllowMachineAuthentication }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsAuthorizationPacTtl }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsAuthorizationPacTtlUnits }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsMachinePacTtl }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsMachinePacTtlUnits }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsServerReturns }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsStatelessSessionResume }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsTunnelPacTtl }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsTunnelPacTtlUnits }},{{ hit.AllowedProtocols.eapFast.eapFastUsePacsUseProactivePacUpdatePrecentage }},{%- else %}N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,{%- endif %}{%- if hit.AllowedProtocols.eapTls %}{{ hit.AllowedProtocols.eapTls.allowEapTlsAuthOfExpiredCerts }},{{ hit.AllowedProtocols.eapTls.eapTlsEnableStatelessSessionResume }},{%- else %}N/A,N/A,{%- endif %}{{ hit.AllowedProtocols.eapTlsLBit }},{%- if hit.AllowedProtocols.eapTtls %}{{ hit.AllowedProtocols.eapTtls.eapTtlsChap }},{{ hit.AllowedProtocols.eapTtls.eapTtlsEapMd5 }},{{ hit.AllowedProtocols.eapTtls.eapTtlsEapMsChapV2 }},{{ hit.AllowedProtocols.eapTtls.eapTtlsEapMsChapV2PwdChange }},{{ hit.AllowedProtocols.eapTtls.eapTtlsEapMsChapV2PwdChangeRetries }},{{ hit.AllowedProtocols.eapTtls.eapTtlsMsChapV1 }},{{ hit.AllowedProtocols.eapTtls.eapTtlsMsChapV2 }},{{ hit.AllowedProtocols.eapTtls.eapTtlsPapAscii }},{%- else %}N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,{%- endif %}{%- if hit.AllowedProtocols.peap %}{{ hit.AllowedProtocols.peap.allowPeapEapGtc }},{{ hit.AllowedProtocols.peap.allowPeapEapGtcPwdChange }},{{ hit.AllowedProtocols.peap.allowPeapEapGtcPwdChangeRetries }},{{ hit.AllowedProtocols.peap.allowPeapEapMsChapV2 }},{{ hit.AllowedProtocols.peap.allowPeapEapMsChapV2PwdChange }},{{ hit.AllowedProtocols.peap.allowPeapEapMsChapV2PwdChangeRetries }},{{ hit.AllowedProtocols.peap.allowPeapEapTls }},{{ hit.AllowedProtocols.peap.allowPeapEapTlsAuthOfExpiredCerts }},{{ hit.AllowedProtocols.peap.allowPeapV0 }},{{ hit.AllowedProtocols.peap.requireCryptobinding }},{%- else %}N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,{%- endif %}{{ hit.AllowedProtocols.processHostLookup }},{{ hit.AllowedProtocols.requireMessageAuth }},{%- if hit.AllowedProtocols.teap %}{{ hit.AllowedProtocols.teap.acceptClientCertDuringTunnelEst }},{{ hit.AllowedProtocols.teap.allowDowngradeMsk }},{{ hit.AllowedProtocols.teap.allowTeapEapMsChapV2 }},{{ hit.AllowedProtocols.teap.allowTeapEapMsChapV2PwdChange }},{{ hit.AllowedProtocols.teap.allowTeapEapMsChapV2PwdChangeRetries }},{{ hit.AllowedProtocols.teap.allowTeapEapTls }},{{ hit.AllowedProtocols.teap.allowTeapEapTlsAuthOfExpiredCerts }},{{ hit.AllowedProtocols.teap.enableEapChaining }}{%- else %}N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A
{%- endif %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/adminuser" in api %}Name,Admin Groups,Change Password,Custom Attributes,Description,Enabled,External User,ID,Inactive Account Never Disabled,Include System Alarms In Email
{%-     for hit in data_to_template %}
{%-         for result in hit %}
{{ result.AdminUser.name }},{{ result.AdminUser.adminGroups }},{{ result.AdminUser.changePassword }},{{ result.AdminUser.customAttributes | replace(","," ") }},{{ result.AdminUser.description }},{{ result.AdminUser.enabled }},{{ result.AdminUser.externalUser }},{{ result.AdminUser.id }},{{ result.AdminUser.inactiveAccountNeverDisabled }},{{ result.AdminUser.includeSystemAlarmsInEmail }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/activedirectory" in api %}Name,ID,Description,Domain,AD Attributes,AD Scopes Names,AD Groups,Aging Time,Auth Protection Type,Country,Department,Email,Enable Callback For Dialin Client,Enable Dialin Permission Check,Enable Failed Auth Protection,Enable Machine Access,Enable Machine Auth,Enable Password Change,Enable Rewrites,Failed Auth Threshold,First Name,Identity Not In AD Behaviour,Job Title,Last Name,Locality,Organizational Unit,Plaintext Auth,Rewrite Match,Rewrite Result,Row ID,Schema,State Or Province,Street Address,Telephone,Unreachable Domains Behaviour,Enable Domain Allowed List
{%-     for hit in data_to_template %}
{%-         for directory in hit %}
{%-             for rule in directory.ERSActiveDirectory.advancedSettings.rewriteRules %}
{{ directory.ERSActiveDirectory.name }},{{ directory.ERSActiveDirectory.id }},{{ directory.ERSActiveDirectory.description }},{{ directory.ERSActiveDirectory.domain }},{{ directory.ERSActiveDirectory.adAttributes.attributes | replace(","," ") }},{{ directory.ERSActiveDirectory.adScopesNames }},{{ directory.ERSActiveDirectory.adgroups.groups | replace(","," ") }},{{ directory.ERSActiveDirectory.advancedSettings.agingTime }},{{ directory.ERSActiveDirectory.advancedSettings.authProtectionType }},{{ directory.ERSActiveDirectory.advancedSettings.country }},{{ directory.ERSActiveDirectory.advancedSettings.department }},{{ directory.ERSActiveDirectory.advancedSettings.email }},{{ directory.ERSActiveDirectory.advancedSettings.enableCallbackForDialinClient }},{{ directory.ERSActiveDirectory.advancedSettings.enableDialinPermissionCheck }},{{ directory.ERSActiveDirectory.advancedSettings.enableFailedAuthProtection }},{{ directory.ERSActiveDirectory.advancedSettings.enableMachineAccess }},{{ directory.ERSActiveDirectory.advancedSettings.enableMachineAuth }},{{ directory.ERSActiveDirectory.advancedSettings.enablePassChange }},{{ directory.ERSActiveDirectory.advancedSettings.enableRewrites }},{{ directory.ERSActiveDirectory.advancedSettings.failedAuthThreshold }},{{ directory.ERSActiveDirectory.advancedSettings.firstName }},{{ directory.ERSActiveDirectory.advancedSettings.identityNotInAdBehaviour }},{{ directory.ERSActiveDirectory.advancedSettings.jobTitle }},{{ directory.ERSActiveDirectory.advancedSettings.lastName }},{{ directory.ERSActiveDirectory.advancedSettings.locality }},{{ directory.ERSActiveDirectory.advancedSettings.organizationalUnit }},{{ directory.ERSActiveDirectory.advancedSettings.plaintextAuth }},{{ rule.rewriteMatch }},{{ rule.rewriteResult }},{{ rule.rowId }},{{ directory.ERSActiveDirectory.advancedSettings.schema }},{{ directory.ERSActiveDirectory.advancedSettings.stateOrProvince }},{{ directory.ERSActiveDirectory.advancedSettings.streetAddress }},{{ directory.ERSActiveDirectory.advancedSettings.telephone }},{{ directory.ERSActiveDirectory.advancedSettings.unreachableDomainsBehaviour }},{{ directory.ERSActiveDirectory.enableDomainAllowedList }}
{%-             endfor %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/authorizationprofile" in api %}Name,Access Type,Left Hand Side Dictionary Attribute Advanced Attribute Value Type,Left Hand Side Dictionary Attribute Attribute Name,Left Hand Side Dictionary Attribute Dictionary Name,Right Hand Side Attribue Value Advanced Attribute Value Type,Right Hand Side Attribute Value Value,Right Hand Side Attribue Attribute Name,Right Hand Side Attribute Dictionary Name,Agentless Posture,AuthZ Profile Type,DACL Name,Description,Easy Wired Session Candidate,ID,Profile Name,Service Template,Track Movement,Voice Domain Permission,Web Redirection Type,Web Redirection ACL,Web Redirection Portal Name
{%-     for hit in data_to_template %}
{%-         for result in hit %}
{%-             if result.AuthorizationProfile.advancedAttributes %}
{%-                 for attribute in result.AuthorizationProfile.advancedAttributes %}
{{ result.AuthorizationProfile.name }},{{ result.AuthorizationProfile.accessType }},{{ attribute.leftHandSideDictionaryAttribue.AdvancedAttributeValueType }},{{ attribute.leftHandSideDictionaryAttribue.attributeName }},{{ attribute.leftHandSideDictionaryAttribue.dictionaryName }},{{ attribute.rightHandSideAttribueValue.AdvancedAttributeValueType }},{{ attribute.rightHandSideAttribueValue.value | default("N/A") }},{{ attribute.rightHandSideAttribueValue.attributeName | default("N/A") }},{{ attribute.rightHandSideAttribueValue.dictionaryName | default("N/A") }},{{ result.AuthorizationProfile.agentlessPosture }},{{ result.AuthorizationProfile.authzProfileType }},{{ result.AuthorizationProfile.daclName | default("N/A") }},{{ result.AuthorizationProfile.description }},{{ result.AuthorizationProfile.easywiredSessionCandidate }},{{ result.AuthorizationProfile.id }},{{ result.AuthorizationProfile.profileName }},{{ result.AuthorizationProfile.serviceTemplate }},{{ result.AuthorizationProfile.trackMovement }},{{ result.AuthorizationProfile.voiceDomainPermission | default("N/A") }},{% if result.AuthorizationProfile.webRedirection %}{{ result.AuthorizationProfile.webRedirection.WebRedirectionType }},{{ result.AuthorizationProfile.webRedirection.acl }},{{ result.AuthorizationProfile.webRedirection.portalName }}{% else %}N/A,N/A,N/A{% endif %}
{%-                 endfor %}
{%-             else %}
{{ result.AuthorizationProfile.name }},{{ result.AuthorizationProfile.accessType }},N/A,N/A,N/A,N/A,N/A,N/A,N/A,{{ result.AuthorizationProfile.agentlessPosture }},{{ result.AuthorizationProfile.authzProfileType }},{{ result.AuthorizationProfile.daclName | default("N/A") }},{{ result.AuthorizationProfile.description }},{{ result.AuthorizationProfile.easywiredSessionCandidate }},{{ result.AuthorizationProfile.id }},{{ result.AuthorizationProfile.profileName }},{{ result.AuthorizationProfile.serviceTemplate }},{{ result.AuthorizationProfile.trackMovement }},{{ result.AuthorizationProfile.voiceDomainPermission | default("N/A") }},{% if result.AuthorizationProfile.webRedirection %}{{ result.AuthorizationProfile.webRedirection.WebRedirectionType }},{{ result.AuthorizationProfile.webRedirection.acl }},{{ result.AuthorizationProfile.webRedirection.portalName }}{% else %}N/A,N/A,N/A{% endif %}
{%-             endif %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/downloadableacl" in api %}Name,ID,DACL,DACL Type,Description
{%-     for hit in data_to_template %}
{%-         for dacl in hit %}
{{ dacl.DownloadableAcl.name }},{{ dacl.DownloadableAcl.id }},{{ dacl.DownloadableAcl.dacl }},{{ dacl.DownloadableAcl.daclType }},{{ dacl.DownloadableAcl.description }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/endpoint" in api %}
{%-     if  "/ers/config/endpointgroup" in api %}Name,ID,Description,System Defined
{%-         for hit in data_to_template %}
{%-             for group in hit %}
{{ group.EndPointGroup.name }},{{ group.EndPointGroup.id }},{{ group.EndPointGroup.description }},{{ group.EndPointGroup.systemDefined }}
{%-             endfor %}
{%-         endfor %}
{%-    else %}
{%-    endif %}
{%- elif "/ers/config/identitygroup" in api %}Name,ID,Description,Parent
{%-     for hit in data_to_template %}
{%-         for group in hit %}
{{ group.IdentityGroup.name }},{{ group.IdentityGroup.id }},{{ group.IdentityGroup.description }},{{ group.IdentityGroup.parent }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/idstoresequence" in api %}Name,ID,Description,Certificate Authentication Profile,Break On Store Fail,ID Store,Order
{%-     for hit in data_to_template %}
{%-         for sequence in hit %}
{%-             for seqitem in sequence.IdStoreSequence['idSeqItem'] %}
{{ sequence.IdStoreSequence.name }},{{ sequence.IdStoreSequence.id }},{{ sequence.IdStoreSequence.description }},{{ sequence.IdStoreSequence.certificateAuthenticationProfile }},{{ sequence.IdStoreSequence.breakOnStoreFail }},{{ seqitem.idstore }},{{ seqitem.order }}
{%-             endfor %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/internaluser" in api %}Name,ID,Change Password,Custom Attributes,Description,Email,Enabled,Expiry Date Enabled,First Name,Last Name,Identity Groups,Password,Password ID Store
{%-     for hit in data_to_template %}
{%-         for user in hit %}
{{ user['InternalUser'].name }},{{ user['InternalUser'].id }},{{ user['InternalUser'].changePassword }},{{ user['InternalUser'].customAttributes }},{{ user['InternalUser'].description }},{{ user['InternalUser'].email }},{{ user['InternalUser'].enabled }},{{ user['InternalUser'].expiryDateEnabled }},{{ user['InternalUser'].firstName }},{{ user['InternalUser'].lastName }},{{ user['InternalUser'].identityGroups }},{{ user['InternalUser'].password }},{{ user['InternalUser'].passwordIDStore }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/networkdevice" in api %}
{%-     if  "/ers/config/networkdevicegroup" in api %}Name,ID,Description,Other Name
{%-         for hit  in data_to_template %}
{%-             for group in hit %}
{{ group.NetworkDeviceGroup.name }},{{ group.NetworkDeviceGroup.id }},{{ group.NetworkDeviceGroup.description }},{{ group.NetworkDeviceGroup.othername }}
{%-             endfor %}
{%-         endfor %}
{%-     else %}Name,ID,Description,Profile Name,CoA Port,IP Address,Subnet Mask,Network Device Group,DTLS Required,Enable Key Wrap,Enable Multi Secret,Key Encryption Key,Key Input Format,Message Authenticator Code Key,Network Protocol,RADIUS Shared Secret
{%-         for hit in data_to_template %}
{%-             for device in hit %}
{%-                 for ip in device['NetworkDevice']['NetworkDeviceIPList'] %}
{%-                     for group in device['NetworkDevice']['NetworkDeviceGroupList'] %}
{{ device['NetworkDevice'].name }},{{ device['NetworkDevice'].id }},{{ device['NetworkDevice'].description }},{{ device['NetworkDevice'].profileName }},{{ device['NetworkDevice'].coaPort }},{{ ip.ipaddress }},{{ ip.mask }},{{ group }},{{ device['NetworkDevice'].authenticationSettings.dtlsRequired }},{{ device['NetworkDevice'].authenticationSettings.enableKeyWrap }},{{ device['NetworkDevice'].authenticationSettings.enableMultiSecret }},{{ device['NetworkDevice'].authenticationSettings.keyEncryptionKey }},{{ device['NetworkDevice'].authenticationSettings.keyInputFormat }},{{ device['NetworkDevice'].authenticationSettings.messageAuthenticatorCodeKey }},{{ device['NetworkDevice'].authenticationSettings.networkProtocol }},{{ device['NetworkDevice'].authenticationSettings.radiusSharedSecret }}
{%-                     endfor %}
{%-                 endfor %}
{%-             endfor %}
{%-         endfor %}
{%-     endif %}
{%- elif "/ers/config/node" in api %}Name,ID,Display Name,FQDN,Gateway,In Deployment,IP v4 Address,IP v6 Address,Node Service Types,Other PAP FQDN,PAP Node,Primary PAP Node,PxGrid Node,SXP IP Address
{%-     for hit  in data_to_template %}
{%-         for node in hit %}
{%-             for v4 in node['Node'].ipAddresses %}
{%-                 if node['Node'].ipV6Addresses %}
{%-                     for v6 in node['Node'].ipV6Addresses %}
{{ node['Node'].name }},{{ node['Node'].id }},{{ node['Node'].displayName }},{{ node['Node'].fqdn }},{{ node['Node'].gateWay }},{{ node['Node'].inDeployment }},{{ v4 }},{{ v6 }},{{ node['Node'].nodeServiceTypes | replace(","," ") }},{{ node['Node'].otherPapFqdn }},{{ node['Node'].papNode }},{{ node['Node'].primaryPapNode }},{{ node['Node'].pxGridNode }},{{ node['Node'].sxpIpAddress }}
{%-                     endfor %}
{%-                 else %}
{{ node['Node'].name }},{{ node['Node'].id }},{{ node['Node'].displayName }},{{ node['Node'].fqdn }},{{ node['Node'].gateWay }},{{ node['Node'].inDeployment }},{{ v4 }},N/A,{{ node['Node'].nodeServiceTypes | replace(","," ") }},{{ node['Node'].otherPapFqdn }},{{ node['Node'].papNode }},{{ node['Node'].primaryPapNode }},{{ node['Node'].pxGridNode }},{{ node['Node'].sxpIpAddress }}
{%-                 endif %}
{%-             endfor %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/portal" in api %}Name,ID,Description,Portal Type,Allow Sponsor To Change Own Password,Guest User Field Label Name,Guest User Field Required,Guest User Field Data Type,Guest User Field Custom Type,Guest User Field Dictionary Label Key
{%-     for hit in data_to_template %}
{%-         for portal in hit %}
{%-             if portal['ERSPortal']['guestUserFieldList'] %}
{%-                 for field in portal['ERSPortal']['guestUserFieldList'] %}
{{ portal['ERSPortal'].name }},{{ portal['ERSPortal'].id }},{{ portal['ERSPortal'].description | replace(","," ") }},{{ portal['ERSPortal'].portalType }},{{ portal['ERSPortal'].allowSponsorToChangeOwnPassword }},{{ field.labelName }},{{ field.required }},{{ field.dataType }},{{ field.customType }},{{ field.dictionaryLabelKey }}
{%-                 endfor %}
{%-             else %}
{{ portal['ERSPortal'].name }},{{ portal['ERSPortal'].id }},{{ portal['ERSPortal'].description | replace(","," ") }},{{ portal['ERSPortal'].portalType }},N/A,N/A,N/A,N/A,N/A,N/A
{%-             endif %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/profilerprofile" in api %}Name,ID,Description
{%-     for hit in data_to_template %}
{%-         for profile in hit %}
{{ profile.ProfilerProfile.name }},{{ profile.ProfilerProfile.id }},{{ profile.ProfilerProfile.description }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/sgt" in api %}Name,ID,Description,Generation ID,Propogate To APIC,Value
{%-     for hit in data_to_template %}
{%-         for sgt in hit %}
{{ sgt.Sgt.name }},{{ sgt.Sgt.id }},{{ sgt.Sgt.description }},{{ sgt.Sgt.generationId }},{{ sgt.Sgt.propogateToApic }},{{ sgt.Sgt.value }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/sgacl" in api %}Name,ID,Description,ACL Content,Generation ID
{%-     for hit in data_to_template %}
{%-         for acl in hit %}
{{ acl.Sgacl.name }},{{ acl.Sgacl.id }},{{ acl.Sgacl.description }},{{ acl.Sgacl.aclcontent }},{{ acl.Sgacl.generationId }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/selfregportal" in api %}Name,ID,Description,Portal Test URL,Portal Type,Banner Title,Contact Text,Footer Element,View Language,Portal Theme ID,Portal Theme Name,AUP Settings Display Frequency,AUP Settings Include AUP,AUP Settings Require Scrolling,Auth Success Redirect,BYOD Registration Settings EndPoint Identity Group ID,BYOD Registration Settings Show Device ID,BYOD Registration Success Settings Success Redirect,BYOD Welcome Settings AUP Display,BYOD Welcome Settings Enable BYOD,BYOD Welcome Settings Enable Guest Access,BYOD Welcome Settings Include AUP,BYOD Welcome Settings Require AUP Acceptance,BYOD Welcome Settings Require MDM,BYOD Welcome Settings Require Scrolling,Change Password Settings Allow Change Password At First Login,Guest Device Registration Settings Allow Guests To Register Devices,Guest Device Registration Settings Auto Register Guest Devices,Login Page Settings Allow Alternate Guest Portal,Login Page Settings Allow Forgot Password,Login Page Settings Allow Guest To Change Password,Login Page Settings Allow Guest To Create Accounts,Login Page Settings Include AUP,Login Page Settings Max Failed Attempts Before Rate Limit,Login Page Settings Require Access Code,Login Page Settings Social Configs Social Media Type,Login Page Settings Social Configs Social Media Value,Login Page Settings Time Between Logins During Rate Limit,Portal Settings Allowed Interfaces,Portal Settings Always Used Language,Portal Settings Assigned Guest Type For Employee,Portal Settings Authentication Method,Portal Settings Certificate Group Tag,Portal Settings Display Lang,Portal Settings Fallback Language,Portal Settings HTTPS,Port Post Login Banner Settings Include Post Access Banner,Self Reg Page Settings Account Validity Duration,Self Reg Page Settings Allow Grace Access,Self Reg Page Settings Approve Deny Links Time Units,Self Reg Page Settings Assign Guests To Guest Type,Self Reg Page Settings Authenticate Sponsors Using Portal List,Self Reg Page Settings Auto Login Self Wait,Self Reg Page Settings Auto Login Time Period,Self Reg Page Settings Credential Notification Using Email,Self Reg Page Settings Credential Notification Using SMS,Self Reg Page Settings Enable Guest Email Blacklist,Self Reg Page Settings Enable Guest Email Whitelist,Self Reg Page Settings Field Company Include,Self Reg Page Settings Field Company Require,Self Reg Page Settings Field Email Address Include,Self Reg Page Settings Field Email Address Require,Self Reg Page Settings Field First Name Include,Self Reg Page Settings Field First Name Require,Self Reg Page Settings Field Last Name Include,Self Reg Page Settings Field Last Name Require,Self Reg Page Settings Field Field Location Include,Self Reg Page Settings Field Field Location Require,Self Reg Page Settings Field Person Being Visited Include,Self Reg Page Settings Field Person Being Visited Require,Self Reg Page Settings Field Phone Number Include,Self Reg Page Settings Field Phone Number Require,Self Reg Page Settings Field Reason For Visit Include,Self Reg Page Settings Field Reason For Visit Require,Self Reg Page Settings Field SMS Provider Include,Self Reg Page Settings Field SMS Provider Require,Self Reg Page Settings Field User Name Include,Self Reg Page Settings Field User Name Require,Self Reg Page Settings Grace Access Expire Interval,Self Reg Page Settings Grace Access Send Account Expiration,Self Reg Page Settings Guest Email Blacklist Domains,Self Reg Page Settings Guest Email Whitelist Domains,Self Reg Page Settings Include AUP,Self Reg Page Settings Post Registration Redirect,Self Reg Page Settings Require AUP Acceptance,Self Reg Page Settings Require Guest Approval,Self Reg Page Settings Require Registration Code,Self Reg Page Settings Selectable Locations,Self Reg Page Settings Selectable SMS Providers,Self Reg Page Settings Sponsor Portal List,Self Reg Success Settings Allow Guest Login From Self Reg Success Page,Self Reg Success Settings Allow Guest Send Self Using Email,Self Reg Success Settings Allow Guest Send Self Using Print,Self Reg Success Settings Allow Guest Send Self Using SMS,Self Reg Success Settings AUP On Page,Self Reg Success Settings Include AUP,Self Reg Success Settings Include Company,Self Reg Success Settings Include Email Address,Self Reg Success Settings Include First Name,Self Reg Success Settings Include Last Name,Self Reg Success Settings Include Location,Self Reg Success Settings Include Password,Self Reg Success Settings Include Person Being Visited,Self Reg Success Settings Include Phone Number,Self Reg Success Settings Include Reason For Visit,Self Reg Success Settings Include SMS Provider,Self Reg Success Settings Include User Name,Self Reg Success Settings Require AUP Acceptance,Self Reg Success Settings Require AUP Scrolling,Support Info Settings Empty Field Display,Support Info Settings Include Browser User Agent,Support Info Settings Include Failure Code,Support Info Settings Include IP Address,Support Info Settings Include MAC Address,Support Info Settings Include Policy Server,Support Info Settings Include Support Info Page
{%-     for hit in data_to_template %}
{%-         for portal in hit %}
{%-             for social in portal.SelfRegPortal.settings.loginPageSettings.socialConfigs %}
{{ portal.SelfRegPortal.name }},{{ portal.SelfRegPortal.id }},{{ portal.SelfRegPortal.description | replace(","," ") }},{{ portal.SelfRegPortal.portalTestUrl }},{{ portal.SelfRegPortal.portalType }},{{ portal.SelfRegPortal.customizations.globalCustomizations.bannerTitle }},{{ portal.SelfRegPortal.customizations.globalCustomizations.contactText }},{{ portal.SelfRegPortal.customizations.globalCustomizations.footerElement }},{{ portal.SelfRegPortal.customizations.language.viewLanguage }},{{ portal.SelfRegPortal.customizations.portalTheme.id }},{{ portal.SelfRegPortal.customizations.portalTheme.name }},{{ portal.SelfRegPortal.settings.aupSettings.displayFrequency }},{{ portal.SelfRegPortal.settings.aupSettings.includeAup }},{{ portal.SelfRegPortal.settings.aupSettings.requireScrolling }},{{ portal.SelfRegPortal.settings.authSuccessSettings.successRedirect }},{{ portal.SelfRegPortal.settings.byodSettings.byodRegistrationSettings.endPointIdentityGroupId }},{{ portal.SelfRegPortal.settings.byodSettings.byodRegistrationSettings.showDeviceID }},{{ portal.SelfRegPortal.settings.byodSettings.byodRegistrationSuccessSettings.successRedirect }},{{ portal.SelfRegPortal.settings.byodSettings.byodWelcomeSettings.aupDisplay }},{{ portal.SelfRegPortal.settings.byodSettings.byodWelcomeSettings.enableBYOD }},{{ portal.SelfRegPortal.settings.byodSettings.byodWelcomeSettings.enableGuestAccess }},{{ portal.SelfRegPortal.settings.byodSettings.byodWelcomeSettings.includeAup }},{{ portal.SelfRegPortal.settings.byodSettings.byodWelcomeSettings.requireAupAcceptance }},{{ portal.SelfRegPortal.settings.byodSettings.byodWelcomeSettings.requireMDM }},{{ portal.SelfRegPortal.settings.byodSettings.byodWelcomeSettings.requireScrolling }},{{ portal.SelfRegPortal.settings.guestChangePasswordSettings.allowChangePasswdAtFirstLogin }},{{ portal.SelfRegPortal.settings.guestDeviceRegistrationSettings.allowGuestsToRegisterDevices }},{{ portal.SelfRegPortal.settings.guestDeviceRegistrationSettings.autoRegisterGuestDevices }},{{ portal.SelfRegPortal.settings.loginPageSettings.allowAlternateGuestPortal }},{{ portal.SelfRegPortal.settings.loginPageSettings.allowForgotPassword }},{{ portal.SelfRegPortal.settings.loginPageSettings.allowGuestToChangePassword }},{{ portal.SelfRegPortal.settings.loginPageSettings.allowGuestToCreateAccounts }},{{ portal.SelfRegPortal.settings.loginPageSettings.includeAup }},{{ portal.SelfRegPortal.settings.loginPageSettings.maxFailedAttemptsBeforeRateLimit }},{{ portal.SelfRegPortal.settings.loginPageSettings.requireAccessCode }},{{ social.socialMediaType }},{{ social.socialMediaValue }},{{ portal.SelfRegPortal.settings.loginPageSettings.timeBetweenLoginsDuringRateLimit }},{{ portal.SelfRegPortal.settings.portalSettings.allowedInterfaces | replace(","," ") }},{{ portal.SelfRegPortal.settings.portalSettings.alwaysUsedLanguage }},{{ portal.SelfRegPortal.settings.portalSettings.assignedGuestTypeForEmployee }},{{ portal.SelfRegPortal.settings.portalSettings.authenticationMethod }},{{ portal.SelfRegPortal.settings.portalSettings.certificateGroupTag }},{{ portal.SelfRegPortal.settings.portalSettings.displayLang }},{{ portal.SelfRegPortal.settings.portalSettings.fallbackLanguage }},{{ portal.SelfRegPortal.settings.portalSettings.httpsPort }},{{ portal.SelfRegPortal.settings.postLoginBannerSettings.includePostAccessBanner }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.accountValidityDuration }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.allowGraceAccess }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.approveDenyLinksTimeUnits }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.assignGuestsToGuestType }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.authenticateSponsorsUsingPortalList }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.autoLoginSelfWait }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.autoLoginTimePeriod }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.credentialNotificationUsingEmail }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.credentialNotificationUsingSms }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.enableGuestEmailBlacklist }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.enableGuestEmailWhitelist }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldCompany.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldCompany.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldEmailAddr.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldEmailAddr.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldFirstName.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldFirstName.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldLastName.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldLastName.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldLocation.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldLocation.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldPersonBeingVisited.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldPersonBeingVisited.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldPhoneNo.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldPhoneNo.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldReasonForVisit.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldReasonForVisit.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldSmsProvider.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldSmsProvider.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldUserName.include }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.fieldUserName.require }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.graceAccessExpireInterval }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.graceAccessSendAccountExpiration }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.guestEmailBlacklistDomains | replace(","," ") }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.guestEmailWhitelistDomains | replace(","," ") }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.includeAup }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.postRegistrationRedirect }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.requireAupAcceptance }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.requireGuestApproval }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.requireRegistrationCode }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.selectableLocations | replace(","," ") }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.selectableSmsProviders | replace(","," ") }},{{ portal.SelfRegPortal.settings.selfRegPageSettings.sponsorPortalList | replace(","," ") }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.allowGuestLoginFromSelfregSuccessPage }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.allowGuestSendSelfUsingEmail }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.allowGuestSendSelfUsingPrint }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.allowGuestSendSelfUsingSms }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.aupOnPage }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeAup }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeCompany }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeEmailAddr }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeFirstName }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeLastName }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeLocation }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includePassword }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includePersonBeingVisited }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includePhoneNo }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeReasonForVisit }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeSmsProvider }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.includeUserName }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.requireAupAcceptance }},{{ portal.SelfRegPortal.settings.selfRegSuccessSettings.requireAupScrolling }},{{ portal.SelfRegPortal.settings.supportInfoSettings.emptyFieldDisplay }},{{ portal.SelfRegPortal.settings.supportInfoSettings.includeBrowserUserAgent }},{{ portal.SelfRegPortal.settings.supportInfoSettings.includeFailureCode }},{{ portal.SelfRegPortal.settings.supportInfoSettings.includeIpAddress }},{{ portal.SelfRegPortal.settings.supportInfoSettings.includeMacAddr }},{{ portal.SelfRegPortal.settings.supportInfoSettings.includePolicyServer }},{{ portal.SelfRegPortal.settings.supportInfoSettings.includeSupportInfoPage }}
{%-             endfor %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/sponsorgroup" in api %}Name,ID,Description,Auto Notification,Can Create Random Accounts,Can Import Multiple Accounts,Can Set Future Start Date,Can Specify Username Prefix,Import Batch Size Limit,Random Batch Size Limit,Start Date Future Limit Days,Guest Types,Is Default Group,Is Enabled,Locations,Manage Permission,Member Groups,Can Access Via REST,Can Approve Self Reg Guests,Can Delete Guest Accounts,Can Extend Guest Accounts,Can Reinstate Suspended Accounts,Can Reset Guest Passwords,Can Send SMS Notifications,Can Suspend Guest Accounts,Can Update Guest Contact Info,Can View Guest Passwords,Limit Approval To Sponsors Guests,Require Suspension Reason
{%-     for hit in data_to_template %}
{%-         for group in hit %}
{{ group.SponsorGroup.name }},{{ group.SponsorGroup.id }},{{ group.SponsorGroup.description | replace(","," ") }},{{ group.SponsorGroup.autoNotification }},{{ group.SponsorGroup.createPermissions.canCreateRandomAccounts }},{{ group.SponsorGroup.createPermissions.canImportMultipleAccounts }},{{ group.SponsorGroup.createPermissions.canSetFutureStartDate }},{{ group.SponsorGroup.createPermissions.canSpecifyUsernamePrefix }},{{ group.SponsorGroup.createPermissions.importBatchSizeLimit }},{{ group.SponsorGroup.createPermissions.randomBatchSizeLimit }},{{ group.SponsorGroup.createPermissions.startDateFutureLimitDays }},{{ group.SponsorGroup.guestTypes | replace(","," ") }},{{ group.SponsorGroup.isDefaultGroup }},{{ group.SponsorGroup.isEnabled }},{{ group.SponsorGroup.locations | replace(","," ") }},{{ group.SponsorGroup.managePermission }},{{ group.SponsorGroup.memberGroups | replace(","," ") }},{{ group.SponsorGroup.otherPermissions.canAccessViaRest }},{{ group.SponsorGroup.otherPermissions.canApproveSelfregGuests }},{{ group.SponsorGroup.otherPermissions.canDeleteGuestAccounts }},{{ group.SponsorGroup.otherPermissions.canExtendGuestAccounts }},{{ group.SponsorGroup.otherPermissions.canReinstateSuspendedAccounts }},{{ group.SponsorGroup.otherPermissions.canResetGuestPasswords }},{{ group.SponsorGroup.otherPermissions.canSendSmsNotifications }},{{ group.SponsorGroup.otherPermissions.canSuspendGuestAccounts }},{{ group.SponsorGroup.otherPermissions.canUpdateGuestContactInfo }},{{ group.SponsorGroup.otherPermissions.canViewGuestPasswords }},{{ group.SponsorGroup.otherPermissions.limitApprovalToSponsorsGuests }},{{ group.SponsorGroup.otherPermissions.requireSuspensionReason }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/sponsorportal" in api %}Name,ID,Description,Portal Test URL,Portal Type,Banner Title,Contact Text,Footer Element,View Language,Portal Theme ID,Portal Theme Name,AUP Settings Display Frequency,AUP Settings Include AUP,AUP Settings Require Scrolling,Login Page Settings Include AUP,Login Page Settings Max Failed Attempts Before Rate Limit,Login Page Settings Require AUP Scrolling,Login Page Settings Social Configs Social Media,Login Page Settings Time Between Logins During Rate Limit,Portal Settings Allowed Interfaces,Portal Settings Authentication Method,Available SSIDs,Portal Settings Certificate Group Tag,Portal Settings Display Lang,Portal Settings Fallback Language,Portal Settings HTTPS Port,Portal Settings Idle Timeout,Post Login Banner Settings Include Post Access Banner,Allow Sponsor To Change Password,Support Info Settings Empty Field Display,Support Info Settings Include Browser User Agent,Support Info Settings Include Failure Code,Support Info Settings Include IP Address,Support Info Settings Include MAC Address,Support Info Settings Include Policy Server,Support Info Settings Include Support Info Page
{%-     for hit in data_to_template %}
{%-         for portal in hit %}
{{ portal.SponsorPortal.name }},{{ portal.SponsorPortal.id }},{{ portal.SponsorPortal.description | replace(","," ") }},{{ portal.SponsorPortal.portalTestUrl }},{{ portal.SponsorPortal.portalType }},{{ portal.SponsorPortal.customizations.globalCustomizations.bannerTitle }},{{ portal.SponsorPortal.customizations.globalCustomizations.contactText }},{{ portal.SponsorPortal.customizations.globalCustomizations.footerElement }},{{ portal.SponsorPortal.customizations.language.viewLanguage }},{{ portal.SponsorPortal.customizations.portalTheme.id }},{{ portal.SponsorPortal.customizations.portalTheme.name }},{{ portal.SponsorPortal.settings.aupSettings.displayFrequency }},{{ portal.SponsorPortal.settings.aupSettings.includeAup }},{{ portal.SponsorPortal.settings.aupSettings.requireScrolling }},{{ portal.SponsorPortal.settings.loginPageSettings.includeAup }},{{ portal.SponsorPortal.settings.loginPageSettings.maxFailedAttemptsBeforeRateLimit }},{{ portal.SponsorPortal.settings.loginPageSettings.requireAupScrolling }},{{ portal.SponsorPortal.settings.loginPageSettings.socialConfigs | replace(","," ") }},{{ portal.SponsorPortal.settings.loginPageSettings.timeBetweenLoginsDuringRateLimit }},{{ portal.SponsorPortal.settings.portalSettings.allowedInterfaces | replace(","," ") }},{{ portal.SponsorPortal.settings.portalSettings.authenticationMethod }},{{ portal.SponsorPortal.settings.portalSettings.availableSsids | replace(","," ") }},{{ portal.SponsorPortal.settings.portalSettings.certificateGroupTag }},{{ portal.SponsorPortal.settings.portalSettings.displayLang }},{{ portal.SponsorPortal.settings.portalSettings.fallbackLanguage }},{{ portal.SponsorPortal.settings.portalSettings.httpsPort }},{{ portal.SponsorPortal.settings.portalSettings.idleTimeout }},{{ portal.SponsorPortal.settings.postLoginBannerSettings.includePostAccessBanner }},{{ portal.SponsorPortal.settings.sponsorChangePasswordSettings.allowSponsorToChangePwd }},{{ portal.SponsorPortal.settings.supportInfoSettings.emptyFieldDisplay }},{{ portal.SponsorPortal.settings.supportInfoSettings.includeBrowserUserAgent }},{{ portal.SponsorPortal.settings.supportInfoSettings.includeFailureCode }},{{ portal.SponsorPortal.settings.supportInfoSettings.includeIpAddress }},{{ portal.SponsorPortal.settings.supportInfoSettings.includeMacAddr }},{{ portal.SponsorPortal.settings.supportInfoSettings.includePolicyServer }},{{ portal.SponsorPortal.settings.supportInfoSettings.includeSupportInfoPage }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/ers/config/sponsoredguestportal" in api %}Name,ID,Description,Portal Test URL,Portal Type,Banner Title,Contact Text,Footer Element,View Language,Portal Theme ID,Portal Theme Name,AUP Settings Display Frequency,AUP Settings Include AUP,AUP Settings Require Scrolling,Auth Success Redirect,BYOD Registration Settings EndPoint Identity Group ID,BYOD Registration Settings Show Device ID,BYOD Registration Success Settings Success Redirect,BYOD Welcome Settings AUP Display,BYOD Welcome Settings Enable BYOD,BYOD Welcome Settings Enable Guest Access,BYOD Welcome Settings Include AUP,BYOD Welcome Settings Require AUP Acceptance,BYOD Welcome Settings Require MDM,BYOD Welcome Settings Require Scrolling,Change Password Settings Allow Change Password At First Login,Guest Device Registration Settings Allow Guests To Register Devices,Guest Device Registration Settings Auto Register Guest Devices,Login Page Settings Allow Alternate Guest Portal,Login Page Settings Allow Forgot Password,Login Page Settings Allow Guest To Change Password,Login Page Settings Allow Guest To Create Accounts,Login Page Settings Include AUP,Login Page Settings Max Failed Attempts Before Rate Limit,Login Page Settings Require Access Code,Login Page Settings Social Configs Social Media Type,Login Page Settings Social Configs Social Media Value,Login Page Settings Time Between Logins During Rate Limit,Portal Settings Allowed Interfaces,Portal Settings Always Used Language,Portal Settings Assigned Guest Type For Employee,Portal Settings Authentication Method,Portal Settings Certificate Group Tag,Portal Settings Display Lang,Portal Settings Fallback Language,Portal Settings HTTPS,Port Post Login Banner Settings Include Post Access Banner,Support Info Settings Empty Field Display,Support Info Settings Include Browser User Agent,Support Info Settings Include Failure Code,Support Info Settings Include IP Address,Support Info Settings Include MAC Address,Support Info Settings Include Policy Server,Support Info Settings Include Support Info Page
{%-     for hit in data_to_template %}
{%-         for portal in hit %}
{%-             for social in portal.SponsoredGuestPortal.settings.loginPageSettings.socialConfigs %}
{{ portal.SponsoredGuestPortal.name }},{{ portal.SponsoredGuestPortal.id }},{{ portal.SponsoredGuestPortal.description | replace(","," ") }},{{ portal.SponsoredGuestPortal.portalTestUrl }},{{ portal.SponsoredGuestPortal.portalType }},{{ portal.SponsoredGuestPortal.customizations.globalCustomizations.bannerTitle }},{{ portal.SponsoredGuestPortal.customizations.globalCustomizations.contactText }},{{ portal.SponsoredGuestPortal.customizations.globalCustomizations.footerElement }},{{ portal.SponsoredGuestPortal.customizations.language.viewLanguage }},{{ portal.SponsoredGuestPortal.customizations.portalTheme.id }},{{ portal.SponsoredGuestPortal.customizations.portalTheme.name }},{{ portal.SponsoredGuestPortal.settings.aupSettings.displayFrequency }},{{ portal.SponsoredGuestPortal.settings.aupSettings.includeAup }},{{ portal.SponsoredGuestPortal.settings.aupSettings.requireScrolling }},{{ portal.SponsoredGuestPortal.settings.authSuccessSettings.successRedirect }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodRegistrationSettings.endPointIdentityGroupId }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodRegistrationSettings.showDeviceID }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodRegistrationSuccessSettings.successRedirect }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodWelcomeSettings.aupDisplay }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodWelcomeSettings.enableBYOD }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodWelcomeSettings.enableGuestAccess }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodWelcomeSettings.includeAup }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodWelcomeSettings.requireAupAcceptance }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodWelcomeSettings.requireMDM }},{{ portal.SponsoredGuestPortal.settings.byodSettings.byodWelcomeSettings.requireScrolling }},{{ portal.SponsoredGuestPortal.settings.guestChangePasswordSettings.allowChangePasswdAtFirstLogin }},{{ portal.SponsoredGuestPortal.settings.guestDeviceRegistrationSettings.allowGuestsToRegisterDevices }},{{ portal.SponsoredGuestPortal.settings.guestDeviceRegistrationSettings.autoRegisterGuestDevices }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.allowAlternateGuestPortal }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.allowForgotPassword }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.allowGuestToChangePassword }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.allowGuestToCreateAccounts }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.includeAup }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.maxFailedAttemptsBeforeRateLimit }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.requireAccessCode }},{{ social.socialMediaType }},{{ social.socialMediaValue }},{{ portal.SponsoredGuestPortal.settings.loginPageSettings.timeBetweenLoginsDuringRateLimit }},{{ portal.SponsoredGuestPortal.settings.portalSettings.allowedInterfaces | replace(","," ") }},{{ portal.SponsoredGuestPortal.settings.portalSettings.alwaysUsedLanguage }},{{ portal.SponsoredGuestPortal.settings.portalSettings.assignedGuestTypeForEmployee }},{{ portal.SponsoredGuestPortal.settings.portalSettings.authenticationMethod }},{{ portal.SponsoredGuestPortal.settings.portalSettings.certificateGroupTag }},{{ portal.SponsoredGuestPortal.settings.portalSettings.displayLang }},{{ portal.SponsoredGuestPortal.settings.portalSettings.fallbackLanguage }},{{ portal.SponsoredGuestPortal.settings.portalSettings.httpsPort }},{{ portal.SponsoredGuestPortal.settings.postLoginBannerSettings.includePostAccessBanner }},{{ portal.SponsoredGuestPortal.settings.supportInfoSettings.emptyFieldDisplay }},{{ portal.SponsoredGuestPortal.settings.supportInfoSettings.includeBrowserUserAgent }},{{ portal.SponsoredGuestPortal.settings.supportInfoSettings.includeFailureCode }},{{ portal.SponsoredGuestPortal.settings.supportInfoSettings.includeIpAddress }},{{ portal.SponsoredGuestPortal.settings.supportInfoSettings.includeMacAddr }},{{ portal.SponsoredGuestPortal.settings.supportInfoSettings.includePolicyServer }},{{ portal.SponsoredGuestPortal.settings.supportInfoSettings.includeSupportInfoPage }}
{%-             endfor %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/api/v1/backup-restore/config/last-backup-status" in api %}Name,Hostname,Action,Details,Error,Initiated From,Just Complete,Message,Percent Complete,Repository,Scheduled,Start Date,Status,Type
{{ data_to_template.response.name }},{{ data_to_template.response.hostName }},{{ data_to_template.response.action }},{{ data_to_template.response.details }},{{ data_to_template.response.error }},{{ data_to_template.response.initiatedFrom }},{{ data_to_template.response.justComplete }},{{ data_to_template.response.message }},{{ data_to_template.response.percentComplete }},{{ data_to_template.response.repository }},{{ data_to_template.response.scheduled }},{{ data_to_template.response.startDate }},{{ data_to_template.response.status }},{{ data_to_template.response.type }}
{%- elif "/api/v1/certs/certificate-signing-request" in api %}Hostname,ID,CSR Contents,Friendly Name,Group Tag,Key Size,Signature Algorithm,Subject,Timestamp,Used For
{%-     if data_to_template['response'] %}
{%-         for cert in data_to_template %}
{{ cert.response.hostName }},{{ cert.response.id }},{{ cert.response.csrContents | replace("\n","") }},{{ cert.response.friendlyName }},{{ cert.response.groupTag }},{{ cert.response.keySize }},{{ cert.response.signatureAlgorithm }},{{ cert.response.subject | replace(","," ") }},{{ cert.response.timeStamp }},{{ cert.response.usedFor }}
{%-         endfor %}
{%-     endif %}
{%- elif "/api/v1/certs/system-certificate" in api %}Friendly Name,ID,Expiration Date,Group Tag,Issued By,Issued To,Key Size,Portals Using The Tag,Self Signed,Serial Number Decimal Format,SHA256 Fingerprint,Signature Algorithm,Used By,Valid From
{%-     for cert in data_to_template %}
{{ cert.response.friendlyName | replace(","," ") }},{{ cert.response.id }},{{ cert.response.expirationDate }},{{ cert.response.groupTag }},{{ cert.response.issuedBy }},{{ cert.response.issuedTo }},{{ cert.response.keySize }},{{ cert.response.portalsUsingTheTag }},{{ cert.response.selfSigned }},{{ cert.response.serialNumberDecimalFormat }},{{ cert.response.sha256Fingerprint }},{{ cert.response.signatureAlgorithm }},{{ cert.response.usedBy }},{{ cert.response.validFrom }}
{%-     endfor %}
{%- elif "/api/v1/certs/trusted-certificate" in api %}Friendly Name,ID,Description,Authenticate Before CRL Received,Automatic CRL Update,Automatic CRL Update Period,Automatic CRL Update Units,CRL Distribution Url,CRL Download Failure Retries,CRL Download Failure Retries Units,Download CRL,Enable OCSP Validation,Enable Server Identity Check,Expiration Date,Ignore CRL Expiration,Internal CA,Is Referred In Policy,Issued By,Issued To,Key Size,Non Automatic CRL Update Period,Non Automatic CRL Update Units,Reject If No Status From OCSP,Reject If Unreachable From OCSP,Selected OCSP Service,Serial Number Decimal Format,SHA256 Fingerprint,Signature Algorithm,Status,Subject,Trusted For,Valid From
{%-     for cert in data_to_template %}
{{ cert.response.friendlyName }},{{ cert.response.id }},{{ cert.response.description | replace(","," ") }},{{ cert.response.authenticateBeforeCRLReceived }},{{ cert.response.automaticCRLUpdate }},{{ cert.response.automaticCRLUpdatePeriod }},{{ cert.response.automaticCRLUpdateUnits }},{{ cert.response.crlDistributionUrl }},{{ cert.response.crlDownloadFailureRetries }},{{ cert.response.crlDownloadFailureRetriesUnits }},{{ cert.response.downloadCRL }},{{ cert.response.enableOCSPValidation }},{{ cert.response.enableServerIdentityCheck }},{{ cert.response.expirationDate }},{{ cert.response.ignoreCRLExpiration }},{{ cert.response.internalCA }},{{ cert.response.isReferredInPolicy }},{{ cert.response.issuedBy }},{{ cert.response.issuedTo }},{{ cert.response.keySize }},{{ cert.response.nonAutomaticCRLUpdatePeriod }},{{ cert.response.nonAutomaticCRLUpdateUnits }},{{ cert.response.rejectIfNoStatusFromOCSP }},{{ cert.response.rejectIfUnreachableFromOCSP }},{{ cert.response.selectedOCSPService }},{{ cert.response.serialNumberDecimalFormat }},{{ cert.response.sha256Fingerprint }},{{ cert.response.signatureAlgorithm }},{{ cert.response.status }},{{ cert.response.subject | replace(","," ") }},{{ cert.response.trustedFor }},{{ cert.response.validFrom }}
{%-     endfor %}
{%- elif "/api/v1/deployment/node" in api %}Hostname,FQDN,IP Address,Node Status,Role,Services
{%-     for node in data_to_template['response'] %}
{%-         for role in node['roles'] %}
{%-             for service in node['services'] %}
{{ node.hostname }},{{ node.fqdn }},{{ node.ipAddress }},{{ node.nodeStatus }},{{ role }},{{ service }}
{%-             endfor %}
{%-         endfor %}
{%-     endfor %}
{%- elif "/api/v1/deployment/pan-ha" in api %}Failed Attempts,Is Enabled,Polling Interval,Primary Health Check Node,Secondary Health Check Node
{{ data_to_template.response.failedAttempts }},{{ data_to_template.response.isEnabled }},{{ data_to_template.response.pollingInterval }},{{ data_to_template.response.primaryHealthCheckNode }},{{ data_to_template.response.secondaryHealthCheckNode }}
{%- elif "/api/v1/node/" in api %}Interface
{%-     for interface in data_to_template['response'] %}
{{ interface.interface }}
{%-     endfor %}
{%- elif "/api/v1/profile/" in api %}Active Directory Days Before Rescan,DHCP Interface,DHCP Port,DHCP Span,DNS,HTTP,NetFlow,NMAP,PxGrid,RADIUS,SNMP Query Event Timeout,SNMP Query Retries,SNMP Query Timeout,SNMP Trap
{%-     for interface in data_to_template['response']['dhcp']['interfaces'] %}
{{ data_to_template['response'].activeDirectory.daysBeforeRescan }},{{ interface.interface }},{{ data_to_template['response'].dhcp.port }},{{ data_to_template['response'].dhcpSpan }},{{ data_to_template['response'].dns }},{{ data_to_template['response'].http }},{{ data_to_template['response'].netflow }},{{ data_to_template['response'].nmap }},{{ data_to_template['response'].pxgrid }},{{ data_to_template['response'].radius }},{{ data_to_template['response'].snmpQuery.eventTimeout }},{{ data_to_template['response'].snmpQuery.retries }},{{ data_to_template['response'].snmpQuery.timeout }},{{ data_to_template['response'].snmpTrap }}
{%-     endfor %}
{%- elif "/api/v1/license/system/connection-type" in api %}Connection Type,State
{{ data_to_template.connectionType }},{{ data_to_template.state }}
{%- elif "/api/v1/license/system/eval-license" in api %}Days Remaining
{{ data_to_template.daysRemaining }}
{%- elif "/api/v1/license/system/feature-to-tier-mapping" in api %}Tier,Feature Name
{%-     for tier in data_to_template %}
{%-         if tier['featureName'] %}
{%-             for feature in tier['featureName'] %}
{{ tier.tier }},{{ feature }}
{%-             endfor %}
{%-         else %}
{{ tier.tier }},N/A
{%-          endif %}
{%-     endfor %}
{%- elif "/api/v1/license/system/register" in api %}Tier,Connection Type,Registration State,SSM On Prem Server
{%-     for license in data_to_template['response']['tier'] %}
{{ license }},{{ data_to_template['response']['connectionType'] }},{{ data_to_template['response']['registrationState'] }},{{ data_to_template['response']['ssmOnPremServer'] }}
{%-     endfor %}
{%- elif "/api/v1/license/system/smart-state" in api %}Connection Type,State
{{ data_to_template.response.connectionType }},{{ data_to_template.response.state }}
{%- elif "/api/v1/license/system/tier-state" in api %}Name,Compliance,Consumption Counter,Days Out Of Compliance,Last Authorization,Status
{%-     for license in data_to_template %}
{{ license.name }},{{ license.compliance }},{{ license.consumptionCounter }},{{ license.daysOutOfCompliance }},{{ license.lastAuthorization }},{{ license.status }}
{%-     endfor %}
{%- elif "/api/v1/patch" in api %}ISE Version,Patch Number,Install Date
{%-     for patch in data_to_template['patchVersion'] %}
{{ data_to_template.iseVersion }},{{ patch.patchNumber }},{{ patch.installDate }}
{%-     endfor %}
{%- elif "/api/v1/hotpatch" in api %}Name,Install Date
{%-     for patch in data_to_template['response'] %}
{{ patch.hotpatchName }},{{ patch.installDate }}
{%-     endfor %}
{%- elif "/api/v1/repository" in api %}Name,Password,Path,Protocol,Server Name,User Name
{%-     for repo in data_to_template['response'] %}
{{ repo.name }},{{ repo.password }},{{ repo.path }},{{ repo.protocol }},{{ repo.serverName }},{{ repo.userName }}
{%-     endfor %}
{%- elif "/api/v1/system-settings/proxy" in api %}Bypass Hosts,FQDN,Password,Password Required,Port,User Name
{{ data_to_template.response.bypassHosts }},{{ data_to_template.response.fqdn }},{{ data_to_template.response.password }},{{ data_to_template.response.passwordRequired }},{{ data_to_template.response.port }},{{ data_to_template.response.userName }}
{%- elif "/api/v1/system-settings/telemetry/transport-gateway" in api %}Enable Transport Gateway,URL
{{ data_to_template.response.enableTransportGateway }},{{ data_to_template.response.url }}
{%- elif "/api/v1/trustsec/sgacl/nbarapp/" in api %}Name,ID,Description,Ports,Protocol
{%-     for app in data_to_template['response'] %}
{%-         for identity in app['networkIdentities'] %}
{{ app.name }},{{ app.id }},{{ app.description }},{{ identity.ports }},{{ identity.protocol }}
{%-         endfor %}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/command-sets" in api %}Name,ID
{%-     for set in data_to_template %}
{{ set.name }},{{ set.id }}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/condition" in api %}Name,ID,Attribute Name,Attribute Value,Condition Type,Description,Dictionary Name,Dictionary Value,Is Negate,Operator
{%-     for condition in data_to_template %}
{{ condition.response.name }},{{ condition.response.id }},{{ condition.response.attributeName }},{{ condition.response.attributeValue }},{{ condition.response.conditionType }},{{ condition.response.description }},{{ condition.response.dictionaryName }},{{ condition.response.dictionaryValue }},{{ condition.response.isNegate }},{{ condition.response.operator }}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/dictionaries/authentication" in api %}Name,Allowed Values is Default,Allowed Values Key,Allowed Values Value,Data Type,Description,Dictionary Name,Direction Type,ID,Internal Name
{%-     for response in data_to_template['response'] %}
{%-         if response['allowedValues'] %}
{%-             for allow_value in response['allowedValues'] %}
{{ response.name }},{{ allow_value.isDefault }},{{ allow_value.key }},{{ allow_value.value }},{{ response.dataType }},{{ response.description }},{{ response.dictionaryName }},{{ response.directionType }},{{ response.id }},{{ response.internalName }}
{%-             endfor %}
{%-         else %}
{{ response.name }},N/A,N/A,N/A,{{ response.dataType }},{{ response.description }},{{ response.dictionaryName }},{{ response.directionType }},{{ response.id }},{{ response.internalName }}
{%-         endif %}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/dictionaries/authorization" in api %}Name,Allowed Values is Default,Allowed Values Key,Allowed Values Value,Data Type,Description,Dictionary Name,Direction Type,ID,Internal Name
{%-     for response in data_to_template['response'] %}
{%-         if response['allowedValues'] %}
{%-             for allow_value in response['allowedValues'] %}
{{ response.name }},{{ allow_value.isDefault }},{{ allow_value.key }},{{ allow_value.value }},{{ response.dataType }},{{ response.description }},{{ response.dictionaryName }},{{ response.directionType }},{{ response.id }},{{ response.internalName }}
{%-             endfor %}
{%-         else %}
{{ response.name }},N/A,N/A,N/A,{{ response.dataType }},{{ response.description }},{{ response.dictionaryName }},{{ response.directionType }},{{ response.id }},{{ response.internalName }}
{%-         endif %}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/dictionaries/policyset" in api %}Name,ID,Internal Name,Data Type,Description,Dictionary Name,Direction Type,Allowed Values Is Default,Allowed Values Key,Allowed Values Value
{%-     for policy_set in data_to_template['response'] %}
{%-         if policy_set['allowedValues'] %}
{%-             for value in policy_set['allowedValues'] %}
{{ policy_set.name }},{{ policy_set.id }},{{ policy_set.internalName }},{{ policy_set.dataType }},{{ policy_set.description }},{{ policy_set.dictionaryName }},{{ policy_set.directionType }},{{ value.isDefault }},{{ value.key }},{{ value.value }}
{%-             endfor %}
{%-         else %}
{{ policy_set.name }},{{ policy_set.id }},{{ policy_set.internalName }},{{ policy_set.dataType }},{{ policy_set.description }},{{ policy_set.dictionaryName }},{{ policy_set.directionType }},N/A,N/A,N/A
{%-         endif %}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/identity-stores" in api %}Name,ID
{%-     for store in data_to_template %}
{{ store.name }},{{ store.id }}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/policy-set" in api %}Name,ID,Condition,Default,Description,Hit Counts,Is Proxy,Rank,Service Name,State
{%-     for set in data_to_template %}
{{ set.response.name }},{{ set.response.id }},{{ set.response.condition }},{{ set.response.default }},{{ set.response.description }},{{ set.response.hitCounts }},{{ set.response.isProxy }},{{ set.response.rank }},{{ set.response.serviceName }},{{ set.response.state }}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/service-names" in api %}Name,ID,Is Local Authorization,Service Type
{%-     for name in data_to_template %}
{{ name.name }},{{ name.id }},{{ name.isLocalAuthorization }},{{ name.serviceType }}
{%-     endfor %}
{%- elif "/api/v1/policy/device-admin/shell-profiles" in api %}Name,ID
{%-     for profile in data_to_template %}
{{ profile.name }},{{ profile.id }}
{%-     endfor %}
{%- elif "/api/v1/policy/network-access/authorization-profiles" in api %}Name,ID
{%-     for profile in data_to_template %}
{{ profile.name }},{{ profile.id }}
{%-     endfor %}
{%- elif "/api/v1/policy/network-access/condition" in api %}
{%-     if  "/api/v1/policy/network-access/condition/authentication" in api %}Name,ID,Attribute Name,Attribute Value,Condition Type,Description,Dictionary Name,Dictionary Value,Is Negate,Operator
{%-         for condition in data_to_template %}
{%-             if condition.response['children'] %}
{%-                 for child in condition.response['children'] %}
{{ condition.response.name }},{{ condition.response.id }},{{ child.attributeName }},{{ child.attributeValue }},{{ child.conditionType }},{{ condition.response.description | replace(","," ")}},{{ child.dictionaryName }},{{ child.dictionaryValue }},{{ child.isNegate }},{{ child.operator }}
{%-                 endfor %}
{%-             else %}
{{ condition.response.name }},{{ condition.response.id }},{{ condition.response.attributeName }},{{ condition.response.attributeValue }},{{ condition.response.conditionType }},{{ condition.response.description | replace(","," ")}},{{ condition.response.dictionaryName }},{{ condition.response.dictionaryValue }},{{ condition.response.isNegate }},{{ condition.response.operator }}
{%-             endif %}
{%-         endfor %}
{%-     elif "/api/v1/policy/network-access/condition/authorization" in api %}Name,ID,Attribute Name,Attribute Value,Condition Type,Description,Dictionary Name,Dictionary Value,Is Negate,Operator
{%-         for condition in data_to_template %}
{%-             if condition.response['children'] %}
{%-                 for child in condition.response['children'] %}
{{ condition.response.name }},{{ condition.response.id }},{{ child.attributeName }},{{ child.attributeValue }},{{ child.conditionType }},{{ condition.response.description | replace(","," ")}},{{ child.dictionaryName }},{{ child.dictionaryValue }},{{ child.isNegate }},{{ child.operator }}
{%-                 endfor %}
{%-             else %}
{{ condition.response.name }},{{ condition.response.id }},{{ condition.response.attributeName }},{{ condition.response.attributeValue }},{{ condition.response.conditionType }},{{ condition.response.description | replace(","," ")}},{{ condition.response.dictionaryName }},{{ condition.response.dictionaryValue }},{{ condition.response.isNegate }},{{ condition.response.operator }}
{%-             endif %}
{%-         endfor %}
{%-     elif "/api/v1/policy/network-access/condition/policyset" in api %}Name,ID,Attribute Name,Attribute Value,Condition Type,Description,Dictionary Name,Dictionary Value,Is Negate,Operator
{%-         for condition in data_to_template %}
{%-             if condition.response['children'] %}
{%-                 for child in condition.response['children'] %}
{{ condition.response.name }},{{ condition.response.id }},{{ child.attributeName }},{{ child.attributeValue }},{{ child.conditionType }},{{ condition.response.description | replace(","," ")}},{{ child.dictionaryName }},{{ child.dictionaryValue }},{{ child.isNegate }},{{ child.operator }}
{%-                 endfor %}
{%-             else %}
{{ condition.response.name }},{{ condition.response.id }},{{ condition.response.attributeName }},{{ condition.response.attributeValue }},{{ condition.response.conditionType }},{{ condition.response.description | replace(","," ")}},{{ condition.response.dictionaryName }},{{ condition.response.dictionaryValue }},{{ condition.response.isNegate }},{{ condition.response.operator }}
{%-             endif %}
{%-         endfor %}
{%-     else %}Name,ID,Attribute Name,Attribute Value,Condition Type,Description,Dictionary Name,Dictionary Value,Is Negate,Operator
{%-         for condition in data_to_template %}
{%-             if condition.response['children'] %}
{%-                 for child in condition.response['children'] %}
{{ condition.response.name }},{{ condition.response.id }},{{ child.attributeName }},{{ child.attributeValue }},{{ child.conditionType }},{{ condition.response.description | replace(","," ")}},{{ child.dictionaryName }},{{ child.dictionaryValue }},{{ child.isNegate }},{{ child.operator }}
{%-                 endfor %}
{%-             else %}
{{ condition.response.name }},{{ condition.response.id }},{{ condition.response.attributeName }},{{ condition.response.attributeValue }},{{ condition.response.conditionType }},{{ condition.response.description | replace(","," ")}},{{ condition.response.dictionaryName }},{{ condition.response.dictionaryValue }},{{ condition.response.isNegate }},{{ condition.response.operator }}
{%-             endif %}
{%-         endfor %}
{%-     endif %}
{%- elif "/api/v1/policy/network-access/dictionaries" in api %}
{%-     if  "/api/v1/policy/network-access/dictionaries/authentication" in api %}Name,ID,Data Type,Description,Dictionary Name,Direction Type,Internal Name,Is Default,Key,Value
{%-         for dictionary in data_to_template['response'] %}
{%-             if dictionary['allowedValues'] %}
{%-                 for value in dictionary['allowedValues'] %}
{{ dictionary.name }},{{ dictionary.id }},{{ dictionary.dataType }},{{ dictionary.description }},{{ dictionary.dictionaryName }},{{ dictionary.directionType }},{{ dictionary.internalName }},{{ value.isDefault }},{{ value.key }},{{ value.value }}
{%-                 endfor %}
{%-             else %}
{{ dictionary.name }},{{ dictionary.id }},{{ dictionary.dataType }},{{ dictionary.description }},{{ dictionary.dictionaryName }},{{ dictionary.directionType }},{{ dictionary.internalName }},N/A,N/A,N/A
{%-             endif %}
{%-         endfor %}
{%-     elif "/api/v1/policy/network-access/dictionaries/authorization" in api %}Name,ID,Data Type,Description,Dictionary Name,Direction Type,Internal Name,Is Default,Key,Value
{%-         for dictionary in data_to_template['response'] %}
{%-             if dictionary['allowedValues'] %}
{%-                 for value in dictionary['allowedValues'] %}
{{ dictionary.name }},{{ dictionary.id }},{{ dictionary.dataType }},{{ dictionary.description }},{{ dictionary.dictionaryName }},{{ dictionary.directionType }},{{ dictionary.internalName }},{{ value.isDefault }},{{ value.key }},{{ value.value }}
{%-                 endfor %}
{%-             else %}
{{ dictionary.name }},{{ dictionary.id }},{{ dictionary.dataType }},{{ dictionary.description }},{{ dictionary.dictionaryName }},{{ dictionary.directionType }},{{ dictionary.internalName }},N/A,N/A,N/A
{%-             endif %}
{%-         endfor %}
{%-     elif "/api/v1/policy/network-access/dictionaries/policyset" in api %}Name,ID,Data Type,Description,Dictionary Name,Direction Type,Internal Name,Is Default,Key,Value
{%-         for dictionary in data_to_template['response'] %}
{%-             if dictionary['allowedValues'] %}
{%-                 for value in dictionary['allowedValues'] %}
{{ dictionary.name }},{{ dictionary.id }},{{ dictionary.dataType }},{{ dictionary.description }},{{ dictionary.dictionaryName }},{{ dictionary.directionType }},{{ dictionary.internalName }},{{ value.isDefault }},{{ value.key }},{{ value.value }}
{%-                 endfor %}
{%-             else %}
{{ dictionary.name }},{{ dictionary.id }},{{ dictionary.dataType }},{{ dictionary.description }},{{ dictionary.dictionaryName }},{{ dictionary.directionType }},{{ dictionary.internalName }},N/A,N/A,N/A
{%-             endif %}
{%-         endfor %}
{%-     else %}Name,ID,Description,Dictionary Attribute Type
{%-         for dictionary in data_to_template %}
{{ dictionary['response'].name }},{{ dictionary['response'].id }},{{ dictionary['response'].description }},{{ dictionary['response'].dictionaryAttrType }}
{%-         endfor %}
{%-     endif %}
{%- elif "/api/v1/policy/network-access/identity-stores" in api %}Name,ID
{%-     for store in data_to_template %}
{{ store.name }},{{ store.id }}
{%-     endfor %}
{%- elif "/api/v1/policy/network-access/policy-set" in api %}Name,ID,Condition,Default,Description,Hit Counts,Is Proxy,Rank,Service Name,State
{%-     for set in data_to_template %}
{{ set['response'].name }},{{ set['response'].id }},{{ set['response'].condition }},{{ set['response'].default }},{{ set['response'].description }},{{ set['response'].hitCounts }},{{ set['response'].isProxy }},{{ set['response'].rank }},{{ set['response'].serviceName }},{{ set['response'].state }}
{%-     endfor %}
{%- elif "/api/v1/policy/network-access/security-groups" in api %}Name,ID
{%-     for group in data_to_template %}
{{ group.name }},{{ group.id }}
{%-     endfor %}
{%- elif "/api/v1/policy/network-access/service-names" in api %}Name,ID,Service Type,Is Local Authorization
{%-     for service in data_to_template %}
{{ service.name }},{{ service.id }},{{ service.serviceType }},{{ service.isLocalAuthorization }}
{%-     endfor %}
{%- elif "/admin/API/mnt/Session/ActiveCount" in api %}Active Session Count
{{ data_to_template.sessionCount.count }}
{%- elif "/admin/API/mnt/Session/PostureCount" in api %}Posture Count
{{ data_to_template.sessionCount.count }}
{%- elif "/admin/API/mnt/Session/ProfilerCount" in api %}Profiler Count
{{ data_to_template.sessionCount.count }}
{%- elif "/admin/API/mnt/Version" in api %}Name,Type of Node,Version
{{ data_to_template.product['@name'] }},{{ data_to_template.product.type_of_node }},{{ data_to_template.product.version }}
{%- elif "/admin/API/mnt/FailureReasons" in api %}ID,Cause,Code,Resolution
{%-     for reason in data_to_template.failureReasonList.failureReason %}
{{ reason['@id'] }},{{ reason.cause | replace(","," ") }},{{ reason.code | replace(","," ") }},{{ reason.resolution | replace(","," ") }}
{%-     endfor %}
{%- endif %}